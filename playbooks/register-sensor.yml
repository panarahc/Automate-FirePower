# A simple playbook to register the manager with the sensor 
#   and then configure the sensor on the manager. A convoluted process made easy!
# This has been validated on both the sensor and the manager. 
---
- hosts: FirePower_Sensors
  remote_user: "{{ user }}"
  tasks:
  # Register Manager to Sensor
  - name: Register Manager
    become: true
    shell: /usr/local/sf/bin/sfcli.pl isto managed {{ manager_ip }} {{ manager_key }}

  # Register Sensor to Manager
  - name: Register Sensor
    become: true
    shell: "/usr/local/sf/bin/register_appliance.pl -h {{ inventory_hostname }} -k {{ manager_key }} -a {{ appliancetype }} -p {{ policy }} -l {{ license }}"
    delegate_to: "{{ manager_ip }}"
